<!DOCTYPE html>
<html>

<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
  </script>
  
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Qijia  Shen


  | Deep MRI Reconstruction Unrolled Optimization Algorithms Meet Neural Networks

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ”¥</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2021/Deep-MRI-Reconstruction-Unrolled-Optimization-Algo-4f9f234d9e42436cb2c37efc284614b8/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  // window.MathJax = {
  //   tex: {
  //     tags: 'ams'
  //   }
  // };
  window.MathJax = {
    tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    processEscapes: true
  },
  svg: {
    fontCache: 'global'
  }
};
</script>

<script defer type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Qijia</span>   Shen
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Deep MRI Reconstruction Unrolled Optimization Algorithms Meet Neural Networks</h1>
    <p class="post-meta">September 25, 2021</p>
  </header>

  <article class="post-content">
    <p>Three categories: <strong>data driven</strong> [6-16], <strong>model driven</strong> [23-26], <strong>integrated</strong> [17-22]</p>

<h2 id="basics-of-deep-learning-and-mri-reconstruction">Basics of deep learning and MRI reconstruction</h2>

<p>Compressed sensing: sparsity prior is enforced by <strong>sparsifying transform</strong> or <strong>data-driven dictionaries. (Cons: high computational complexity)</strong></p>

<p>deep learning: goes beyond CS by extending key ingredients of CS, <strong>adaptive sparsity</strong> and <strong>non-linearity of the representation</strong></p>

<h2 id="model-driven-deep-learning-for-fast-mr">Model-driven deep learning for fast MR</h2>

<p>establish the model â†’ choose optimization algorithm â†’ unroll the algorithm to deep network</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled.png" data-zoomable="" /></div></div>

<h3 id="1-admm-net-alternating-direction-method-of-multipliers-single-coil">1) ADMM-net (alternating direction method of multipliers) (single coil)</h3>

<p><strong>basic-ADMM-CSNet</strong>: learns the regularization parameters in the ADMM algorithm</p>

<p>(<em>Deep ADMM-Net for Compressive Sensing MRI</em>) (read code)</p>

\[min\quad \frac{1}{2}||Am-f||_2^2+\sum _l\lambda_lg(\mathbf{z_l})+\sum_l&lt;\mathbf{\beta_l,D_lm-z_l}&gt;+\sum_l\frac{\rho_l}{2}||\mathbf{z_l-D_lm}||_2^2\]

<p>augmented Lagrangian function: æœ€åä¸€é¡¹æ˜¯penalty</p>

<p>&lt; = &gt;</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%201.png" data-zoomable="" /></div></div>

<p>æ±‚å¾—</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%202.png" data-zoomable="" /></div></div>

<p><strong>Generic-ADMM-CSNet</strong>: learns the image transformations and nonlinear operators used for the regularization function</p>

<p>(<em>ADMM-CSNet: A Deep Learning Approach for Image Compressive Sensing</em>)</p>

<p><strong>åŒºåˆ«åœ¨äº</strong>$\mathbf{z={z_1,z_2,â€¦,z_l}}$æ˜¯åœ¨spatial domainï¼Œå› æ­¤$\mathbf{D_lz}$ is sparse</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%203.png" data-zoomable="" /></div></div>

<h3 id="2-variational-net-multi-coil">2) Variational-net (multi-coil)</h3>

<p>(<em>Learning a variational network for reconstruction of accelerated MRI data</em>) (read code)</p>

<p>$G(\mathbf{m})=\sum_l&lt;g_l(\mathbf{D_lm}),1&gt;$</p>

<p>å…¶ä¸­$D_l$è¡¨ç¤ºconvolution with kernel $\mathbf{K_l}$ (<strong>learnable params</strong>)</p>

<p>$H_l^{(n)}$æ˜¯activation function(<strong>learnable params</strong>)</p>

<p>$\lambda^{(n)}$ (<strong>learnable params</strong>)</p>

<p>$A$ç”±sub-Nyquist Fourier encodingå’Œsensitivity encoding æ„æˆ</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%204.png" data-zoomable="" /></div></div>

<h3 id="3-ista-net-iterative-shrinkage-thresholding-algorithm">3) ISTA-net (iterative shrinkage-thresholding algorithm)</h3>

<p>(<em>ISTA-Net: Interpretable Optimization-Inspired Deep Network for Image Compressive Sensing</em>)</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%205.png" data-zoomable="" /></div></div>

<p>ä¼ ç»Ÿçš„ISTAç®—æ³•</p>

<p>å…¶ä¸­$G(\mathbf{m})=\lambda||\mathbf{Dm}||_1$ï¼Œ$\rho$æ˜¯step size</p>

<p>ä¼ ç»ŸISTAç®—æ³•ç¼ºç‚¹æ˜¯å½“$\mathbf{D}$æ˜¯non-orthogonal, non-linearçš„æ—¶å€™ï¼Œå¾ˆéš¾ç®—å‡º$\mathbf{m}^{(n+1)}$</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%206.png" data-zoomable="" /></div></div>

<p>ISTA-net</p>

<p>ISTA net å°†ISTAçš„ä¼˜åŒ–ç›®æ ‡æ”¹æˆäº†å¦‚ä¸‹å½¢å¼</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%207.png" data-zoomable="" /></div></div>

<p>è¿›è€Œè·å¾—è§£å¦‚ä¸‹ï¼Ÿ</p>

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%208.png" data-zoomable="" /></div></div>

<h2 id="data-driven-deep-learning-for-fast-mr">Data-driven deep learning for fast MR</h2>

<p>aliased image â†’ clean image (<em>Accelerating Magnetic Resonance Imaging via Deep Learning</em>)</p>

<h3 id="1-basic-data-driven-network-for-mr-reconstruction">1) Basic data-driven network for MR reconstruction</h3>

<p>AUTOMAP: k-space data â†’ 1 layer fully-connected network â†’ reconstructed image</p>

<p>RAKI: 3 layer CNN for k-space interpolation (parallel imaging)</p>

<p>GAN: correct aliasing artifacts from undersampled data</p>

<p>(<em>Compressed Sensing MRI Reconstruction Using a Generative Adversarial Network With a Cyclic Loss</em>)</p>

<p>(<em>Deep Generative Adversarial Neural Networks for Compressive Sensing MRI</em>)</p>

<p>QSMnet: 3D U-Net â†’ QSM from single orientation data</p>

<p>DRONE: 4-layer MLP â†’ tissue properties and predict T1 and T2 from 2D MRF data.</p>

<h3 id="2-domain-knowledge-from-mri">2) Domain knowledge from MRI</h3>

<ul>
  <li>Fourier transform
    <ul>
      <li></li>
    </ul>
  </li>
  <li>
    <p>Regularization term</p>

    <p>2 options to integrate <strong>network</strong> and <strong>CS</strong></p>

    <p>read (<em>Accelerating Magnetic Resonance Imaging via Deep Learning</em>)</p>

    <ul>
      <li>use the image reconstructed from the trained network as <strong>initialization</strong> for CS</li>
      <li>use the image generated by network as reference image in additional regularization</li>
    </ul>
  </li>
  <li>
    <p>Data consistency</p>

    <p>consistency between data in image space and k-space</p>

    <ul>
      <li>KIKI-net</li>
    </ul>

    <div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%209.png" data-zoomable="" /></div></div>
  </li>
  <li>spatio-temporal correlations
    <ul>
      <li>residual U-net</li>
      <li>convolutional RNN</li>
    </ul>
  </li>
  <li>Quantitative parameters</li>
</ul>

<h2 id="integrated-deep-learning-for-fast-mr">Integrated deep learning for fast MR</h2>

<p>ç‰¹ç‚¹</p>

<ul>
  <li>It is an unrolling version of optimization algorithm</li>
  <li>at least one sub-problem is solved using data-driven â€œblack boxâ€</li>
</ul>

<h3 id="1-connection-between-two-approaches">1) Connection between two approaches</h3>

<h3 id="2-integrated-approaches-for-mr-reconstruction">2) Integrated approaches for MR reconstruction</h3>

<ul>
  <li>MoDL</li>
</ul>

<p><em>MoDL: Model-Based Deep Learning Architecture for Inverse Problems</em></p>

\[\mathbf{m}^{(n+1)}=argmin||\mathbf{Am-f}||_2^2+\lambda||\mathbf{m-z^{(n)}}||^2_2\]

\[\mathbf{z}^{(n+1)}=C(\mathbf{m}^{(n+1)})\]

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%2010.png" data-zoomable="" /></div></div>

<p><strong>regularization term</strong>: é™å™ªåçš„å’Œé™å™ªå‰çš„å›¾åƒçš„å·®åˆ«æ˜¯ç¨€ç–çš„</p>

<ul>
  <li>DCCNN</li>
</ul>

<p><em>A Deep Cascade of Convolutional Neural Networks for Dynamic MR Image Reconstruction</em></p>

<ul>
  <li>PD-net</li>
</ul>

<p><em>Learning Primal Dual Network for Fast MR Imaging</em></p>

<p>unrolling version of the primal dual algorithm</p>

\[min\quad F(\mathbf{Am})+G(\mathbf{m)}\]

\[\left\{\begin{aligned}
  d_{n+1}&amp;=C_1(d_n,Am_n,f)\\
  m_{n+1}&amp;=C_2(m_n,A^{*}d_{n+1})\\
\end{aligned}\right.\]

<div class="row mt-3"><div class="col-sm mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1" src="/assets/img/Deep%20MRI%20Reconstruction%20Unrolled%20Optimization%20Algo%204f9f234d9e42436cb2c37efc284614b8/Untitled%2011.png" data-zoomable="" /></div></div>

<h2 id="some-signal-processing-issues">Some signal processing issues</h2>

<h3 id="1-theoretical-analysis">1) Theoretical analysis</h3>

<p>framelet</p>

<h3 id="2-transfer-learning">2) Transfer learning</h3>

<ul>
  <li>
    <p>contrast, SNR, image content difference between training &amp; testing data</p>

    <p>â†’ noise + slightly blurred images with <strong>residual artifacts</strong></p>
  </li>
  <li>network trained on regular undersampled data can be generalized to randomly undersampled data</li>
  <li>
    <p>AUTOMAP: train on natural images â†’ apply to MRI images</p>

    <p><em>Image reconstruction by domain-transform manifold learning</em></p>
  </li>
</ul>

<h3 id="3-relationship-with-other-learning-based-approaches">3) Relationship with other learning-based approaches</h3>

<ul>
  <li>
    <p>compressed sensing with dictionary learning</p>

    <p><strong>linear transform learned using simulated data from theoretical model/ low-res image</strong></p>

    <p><em>MR image reconstruction from highly undersampled k-space data by dictionary learning</em></p>

    <p><em>Adaptive Dictionary Learning in Sparse Gradient Domain for Image Recovery</em></p>
  </li>
  <li>
    <p>compressed sensing with manifold learning</p>

    <p><strong>nonlinear prior of low-dim manifold is learned from training data</strong></p>
  </li>
</ul>

<h3 id="4-other-issues-in-deep-learning-approaches">4) Other issues in deep learning approaches</h3>

<p>separate the <strong>real</strong> &amp; <strong>imaginary</strong>  / <strong>magnitude</strong> &amp; <strong>phase</strong> parts into two channels</p>

<p>To handle <strong>multi-coil</strong> data:</p>

<ul>
  <li>convey the pre-calculated coil sensitivity into the network</li>
  <li>reconstruct the image from the multi-channel data through network</li>
  <li>learns the k-space interpolation from ACS data</li>
</ul>

<p>Non-cartesian reconstruction</p>

<ul>
  <li>AUTOMAP: reconstruct directly from non-Cartesian samples</li>
  <li>domain adaptation from CT projection</li>
</ul>

<p><em>Deep learning with domain adaptation for accelerated projection-reconstruction MR</em></p>

<h3 id="5-future-directions">5) Future Directions</h3>

<p>Deep learning to integrate reconstruction &amp; diagnostic</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    <!-- 
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2023 Qijia  Shen.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank">Unsplash</a>.

    
    
  </div>
</footer>

 -->

  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
