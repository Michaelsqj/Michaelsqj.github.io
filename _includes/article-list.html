{%- assign _excerpt_truncate = include.excerpt_truncate | default: 350 -%}

{%- assign _excerpt_type = include.excerpt_type -%}

{%- assign _sorted_list = include.articles -%}
<!-- {%- if include.group_by == 'year' -%}
  {%- assign _sorted_list = _sorted_list | sort: 'year' -%}
{%- endif -%} -->
{%- if include.group_by == 'title' -%}
  {%- assign _sorted_list = _sorted_list | sort: 'title' -%}
{%- endif -%}
{%- if include.reverse -%}
  {%- assign _sorted_list = _sorted_list | reverse -%}
{%- endif -%}

<div class="article-list items">
  {%- for _article in _sorted_list -%}

    {%- include snippets/prepend-baseurl.html path=_article.url -%}
    {%- assign _article_url = __return -%}

    {%- if _article.cover -%}
      {%- include snippets/get-nav-url.html path=_article.cover -%}
      {%- assign _article_cover = __return -%}
    {%- endif -%}

    {%- assign _tags = '' -%}
    {%- for _tag in _article.tags -%}
      {%- assign _tag_encode = _tag | strip | url_encode -%}
      {%- if forloop.last -%}
        {%- assign _tags = _tags | append: _tag_encode -%}
      {%- else -%}
        {%- assign _tags = _tags | append: _tag_encode | append: ',' -%}
      {%- endif -%}
    {%- endfor -%}
    <!-- {%- if include.group_by == 'year' -%}
      {%- assign _currentdate = _article.date | date: '%Y' -%}
      {%- if _currentdate != _date -%}
        {%- unless forloop.first -%}</ul></section>{%- endunless -%}
        <section><h2 class="article-list__group-header">{{ _currentdate }}</h2><ul class="items">
        {%- assign _date = _currentdate -%}
      {%- endif -%}
    {%- endif -%} -->

    {%- if include.group_by == 'title' -%}
      {%- assign _currentdate = _article.title | slice: 0 -%}
      {%- if _currentdate != _date -%}
        {%- unless forloop.first -%}</ul></section>{%- endunless -%}
        <section><h2 class="article-list__group-header">{{ _currentdate }}</h2><ul class="items">
        {%- assign _date = _currentdate -%}
      {%- endif -%}
    {%- endif -%}
    
    <li class="item" itemscope itemtype="http://schema.org/BlogPosting" data-tags="{{ _tags }}">
      <div class="item__content">
        <span class="item__meta">{{ _article.status }}</span>
        <a itemprop="headline" class="item__header" href="{{ _article_url }}">{{ _article.title }}</a></div>
    </li>
  {%- endfor -%}

</div>
